<!DOCTYPE html>
<html lang="pt-BR">
<head>
<link rel="manifest" href="manifest.json">
<link rel="icon" href="https://i.imgur.com/fVyAd9E.jpeg">
<link rel="apple-touch-icon" href="https://i.imgur.com/fVyAd9E.jpeg">
<meta name="theme-color" content="#1e90ff">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Player</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: radial-gradient(circle at top, #0f2027, #203a43, #2c5364);
      color: #eee;
      padding: 20px;
      max-width: 700px;
      margin: auto;
      text-shadow: 0 0 10px #00e5ff;
    }
    h1 {
      text-align: center;
      color: #00e5ff;
      margin-bottom: 30px;
      font-size: 2.5em;
      text-shadow: 0 0 15px #00e5ff, 0 0 30px #00b0ff;
    }
    .buttons {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      gap: 12px;
      flex-wrap: wrap;
    }
    button {
      padding: 12px 25px;
      background: linear-gradient(145deg, #0a0a0a, #1e1e1e);
      border: 1px solid #00e5ff;
      border-radius: 12px;
      color: #00e5ff;
      font-size: 17px;
      cursor: pointer;
      transition: 0.3s ease;
      box-shadow: 0 0 15px rgba(0,229,255,0.3);
    }
    button:hover {
      background: #00e5ff;
      color: #121212;
      box-shadow: 0 0 20px #00e5ff, 0 0 40px #00b0ff;
    }
    #musicList {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      max-height: 400px;
      overflow-y: auto;
    }
    .music-item {
      cursor: pointer;
      padding: 12px 20px;
      background: rgba(0,0,0,0.5);
      border: 1px solid #00e5ff;
      border-radius: 12px;
      transition: 0.3s ease;
    }
    .music-item:hover {
      background: #00e5ff;
      color: #121212;
      box-shadow: 0 0 15px #00e5ff;
    }
    .music-title {
      font-size: 18px;
      font-weight: 600;
    }
    .music-author {
      font-size: 14px;
      font-style: italic;
      color: #aaa;
    }
    audio {
      width: 100%;
      height: 60px;
      margin-top: 25px;
      border-radius: 8px;
      background: #000;
      border: 1px solid #00e5ff;
      box-shadow: 0 0 15px rgba(0,229,255,0.3);
    }
    .controls {
      margin-top: 15px;
      text-align: center;
      color: #ccc;
    }
    .controls select, .controls input[type="range"] {
      margin: 0 8px;
    }
    .controls label {
      margin-right: 15px;
      user-select: none;
    }
    #metronomoContainer {
      display: none;
      justify-content: center;
      margin-top: 15px;
      gap: 10px;
      flex-wrap: wrap;
    }
    #metronomoContainer input {
      width: 60px;
      text-align: center;
    }
    h3 {
      text-align:center; 
      color:#00e5ff; 
      cursor:pointer; 
      margin-top:20px;
      text-shadow: 0 0 12px #00e5ff;
    }
  </style>
</head>
<body>
<div id="bloqueio" style="position:fixed;top:0;left:0;width:100%;height:100%;background:#111;color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999;">
  <h2>Digite a senha para acessar o site</h2>
  <input type="password" id="senhaInput" style="padding:10px;font-size:16px;" placeholder="Senha">
  <button id="btnEntrar" style="padding:10px 20px;margin-top:10px;font-size:16px;">Entrar</button>
<a href="https://wa.me/558486222876?text=Ol√°,%20quero%20falar%20com%20voc√™s!" 
   target="_blank" 
   style="display: inline-block; margin-top: 10px; padding: 5px 15px; background-color: #25D366; color: white; border-radius: 8px; text-decoration: none; font-weight: bold;">
  üì± Fale conosco
</a>
  <p id="mensagem" style="color:red;margin-top:10px;"></p>
</div>

<script>
  const senhasValidas = ["AB002500", "A002501", "A002502", "A002503", "A002504",
"A002505", "A002506", "A002507", "A002508", "A002509",
"A002510", "A002511", "A002512", "A002513", "A002514",
"A002515", "A002516", "A002517", "A002518", "A002519",
"A002520", "A002521", "A002522", "A002523", "A002524",
"A002525", "A002526", "A002527", "A002528", "A002529",
"A002530", "A002531", "A002532", "A002533", "A002534",
"A002535", "A002536", "A002537", "A002538", "A002539",
"A002540", "A002541", "A002542", "A002543", "A002544",
"A002545", "A002546", "A002547", "A002548", "A002549",
"A002550", "A002551", "A002552", "A002553", "A002554",
"A002555", "A002556", "A002557", "A002558", "A002559",
"A002560", "A002561", "A002562", "A002563", "A002564",
"A002565", "A002566", "A002567", "A002568", "A002569",
"A002570", "A002571", "A002572", "A002573", "A002574",
"A002575", "A002576", "A002577", "A002578", "A002579",
"A002580", "A002581", "A002582", "A002583", "A002584",
"A002585", "A002586", "A002587", "A002588", "A002589",
"A002590", "A002591", "A002592", "A002593", "A002594", "A002595"]; // coloque suas senhas aqui
  const bloqueio = document.getElementById('bloqueio');
  const senhaInput = document.getElementById('senhaInput');
  const btnEntrar = document.getElementById('btnEntrar');
  const mensagem = document.getElementById('mensagem');

  // verifica se j√° existe senha salva
  let senhaSalva = localStorage.getItem('senhaCache');
  if(senhaSalva && senhasValidas.includes(senhaSalva)){
    bloqueio.style.display = 'none'; // libera conte√∫do automaticamente
  }

  function verificarSenha(){
    const senha = senhaInput.value.trim();
    if(senhasValidas.includes(senha)){
      localStorage.setItem('senhaCache', senha);
      bloqueio.style.display = 'none';
    } else {
      mensagem.textContent = "Senha incorreta!";
      senhaInput.value = "";
    }
  }

  btnEntrar.addEventListener('click', verificarSenha);
  senhaInput.addEventListener('keydown', e => { if(e.key === 'Enter') verificarSenha(); });
</script>
<h1>Player</h1>

<div class="buttons">
  <button onclick="document.getElementById('fileInput').click()">üìÅ Carregar Arquivo Local</button>
</div>

<input type="file" id="fileInput" accept="audio/*" style="display:none" multiple onchange="carregarArquivos(event)" />

<div id="musicList"></div>

<audio id="audioPlayer" controls></audio>

<!-- Controles do Metr√¥nomo -->
<div id="metronomoContainer">
  <button id="btnMenosBPM">‚àí</button>
  <button id="btnMetronomo">üéµ Metr√¥nomo: OFF</button>
  <button id="btnMaisBPM">+</button>
  <input type="number" id="inputBPM" min="40" max="200" value="60" title="BPM (40 a 200)">
</div>

<hr>
<h3 onclick="alternarAvancado()">üéõÔ∏è Metr√¥nomo Loop e Equalizar</h3>

<div id="avancado" style="display:none;">
  <div class="buttons">
    <button onclick="marcarInicioLoop()">‚ñ∂Ô∏è Marcar In√≠cio do Loop</button>
    <button onclick="marcarFimLoop()">‚èπÔ∏è Marcar Fim do Loop</button>
    <button onclick="desativarTrechoLoop()">‚õî Desativar Loop</button>
    <button id="btnLoopGeral" onclick="toggleLoopGeral()">üîÅ Repetir Lista: OFF</button>
    <button id="btnLoopMusica" onclick="toggleLoopMusica()">üîÇ Repetir M√∫sica: OFF</button>
    <button onclick="alternarVelocidade()">‚è© Velocidade: 1x</button>
  </div>
</div>

<div class="controls" id="equalizador" style="display:none;">
  <label>Grave:
    <input type="range" min="-30" max="30" value="0" oninput="ajustarEqualizador(0, this.value)">
  </label>
  <label>M√©dio:
    <input type="range" min="-30" max="30" value="0" oninput="ajustarEqualizador(1, this.value)">
  </label>
  <label>Agudo:
    <input type="range" min="-30" max="30" value="0" oninput="ajustarEqualizador(2, this.value)">
  </label>
</div>

<script>
const musicas = [];
const musicListDiv = document.getElementById('musicList');
const audioPlayer = document.getElementById('audioPlayer');
const btnLoopGeral = document.getElementById('btnLoopGeral');
const btnLoopMusica = document.getElementById('btnLoopMusica');
let repetirLista = false;
let repetirMusica = false;

function montarLista() {
  musicListDiv.innerHTML = '';
  musicas.forEach((musica, i) => {
    let autor = '', titulo = musica.nome;
    if (musica.nome.includes(' - ')) {
      [autor, titulo] = musica.nome.split(' - ').map(s => s.trim());
      titulo = titulo.replace(/\.[^/.]+$/, "");
    } else {
      titulo = musica.nome.replace(/\.[^/.]+$/, "");
    }

    const div = document.createElement('div');
    div.className = 'music-item';
    div.innerHTML = `<div class="music-title">${titulo}</div><div class="music-author">${autor}</div>`;
    div.onclick = () => tocarMusica(i);
    musicListDiv.appendChild(div);
  });
}

function carregarArquivos(event) {
  const files = event.target.files;
  for (let file of files) {
    const url = URL.createObjectURL(file);
    musicas.push({ nome: file.name, arquivo: url });
  }
  montarLista();
  if (musicas.length > 0) tocarMusica(0);
}

let musicaAtual = 0;

function tocarMusica(index) {
  musicaAtual = index;
  audioPlayer.src = musicas[index].arquivo;
  audioPlayer.play();
  audioPlayer.loop = repetirMusica;
  loopAtivo = false;
  loopInicio = 0;
  loopFim = 0;
}

audioPlayer.addEventListener('ended', () => {
  if (repetirMusica) return;
  if (repetirLista) {
    musicaAtual = (musicaAtual + 1) % musicas.length;
    tocarMusica(musicaAtual);
  } else if (musicaAtual + 1 < musicas.length) {
    musicaAtual++;
    tocarMusica(musicaAtual);
  }
});

function toggleLoopGeral() {
  repetirLista = !repetirLista;
  btnLoopGeral.innerText = repetirLista ? "üîÅ Repetir Lista: ON" : "üîÅ Repetir Lista: OFF";
}

function toggleLoopMusica() {
  repetirMusica = !repetirMusica;
  audioPlayer.loop = repetirMusica;
  btnLoopMusica.innerText = repetirMusica ? "üîÇ Repetir M√∫sica: ON" : "üîÇ Repetir M√∫sica: OFF";
}

// Equalizador
let audioCtx, sourceNode, gainNode, filters = [];
function initAudioContext() {
  if (!audioCtx) {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    sourceNode = audioCtx.createMediaElementSource(audioPlayer);
    gainNode = audioCtx.createGain();
    const freqs = [60, 1000, 5000];
    filters = freqs.map(f => {
      let filter = audioCtx.createBiquadFilter();
      filter.type = "peaking";
      filter.frequency.value = f;
      filter.Q.value = 1;
      filter.gain.value = 0;
      return filter;
    });
    sourceNode.connect(filters[0]);
    filters.reduce((a, b) => (a.connect(b), b));
    filters[filters.length - 1].connect(gainNode);
    gainNode.connect(audioCtx.destination);
  }
}
function ajustarEqualizador(index, valor) {
  initAudioContext();
  filters[index].gain.value = parseFloat(valor);
}

// Loop de trecho
let loopInicio = 0, loopFim = 0, loopAtivo = false;
function marcarInicioLoop() {
  loopInicio = audioPlayer.currentTime;
  if (loopFim > 0 && loopFim <= loopInicio) loopFim = 0;
  loopAtivo = loopFim > loopInicio;
  alert(`‚ñ∂Ô∏è In√≠cio marcado em ${loopInicio.toFixed(2)}s`);
}
function marcarFimLoop() {
  if (loopInicio === 0) return alert("‚ö†Ô∏è Marque o in√≠cio primeiro.");
  loopFim = audioPlayer.currentTime;
  if (loopFim <= loopInicio) return alert("‚ö†Ô∏è Fim deve ser maior que in√≠cio.");
  loopAtivo = true;
  alert(`‚èπÔ∏è Fim marcado em ${loopFim.toFixed(2)}s`);
}
function desativarTrechoLoop() {
  loopAtivo = false;
  loopInicio = 0;
  loopFim = 0;
  alert("‚õî Loop de trecho desativado.");
}
audioPlayer.ontimeupdate = () => {
  if (loopAtivo && audioPlayer.currentTime >= loopFim && loopFim > loopInicio) {
    audioPlayer.currentTime = loopInicio;
    audioPlayer.play();
  }
};

// Velocidade
let velocidades = [0.5, 0.75, 1, 1.25, 1.5, 2];
let indiceVelocidade = 2;
function alternarVelocidade() {
  indiceVelocidade = (indiceVelocidade + 1) % velocidades.length;
  const novaVelocidade = velocidades[indiceVelocidade];
  audioPlayer.playbackRate = novaVelocidade;
  event.target.innerText = `‚è© Velocidade: ${novaVelocidade}x`;
}

// Mostrar/Ocultar avan√ßado com 3 estados
let modoAvancado = 0;
function alternarAvancado() {
  const divAvancado = document.getElementById('avancado');
  const eq = document.getElementById('equalizador');
  const met = document.getElementById('metronomoContainer');

  modoAvancado = (modoAvancado + 1) % 3;

  if (modoAvancado === 0) {
    divAvancado.style.display = 'none';
    eq.style.display = 'none';
    met.style.display = 'none';
  } else if (modoAvancado === 1) {
    divAvancado.style.display = 'block';
    met.style.display = 'flex';
    eq.style.display = 'none';
  } else if (modoAvancado === 2) {
    divAvancado.style.display = 'none';
    met.style.display = 'none';
    eq.style.display = 'flex';
  }
}

window.onload = montarLista;

// --- Metr√¥nomo ---
let metronomoAtivo = false;
let bpm = 60;
let intervalId = null;
let audioCtxGlobal = null;
function tocarClique() {
  if (!audioCtxGlobal) return;
  const osc = audioCtxGlobal.createOscillator();
  const gainNode = audioCtxGlobal.createGain();
  osc.type = 'square';
  osc.frequency.setValueAtTime(1000, audioCtxGlobal.currentTime);
  gainNode.gain.setValueAtTime(1, audioCtxGlobal.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.001, audioCtxGlobal.currentTime + 0.05);
  osc.connect(gainNode);
  gainNode.connect(audioCtxGlobal.destination);
  osc.start(audioCtxGlobal.currentTime);
  osc.stop(audioCtxGlobal.currentTime + 0.05);
}
function iniciarMetronomo() {
  if (!audioCtxGlobal) {
    audioCtxGlobal = new (window.AudioContext || window.webkitAudioContext)();
  }
  if (intervalId) clearInterval(intervalId);
  const intervalo = 60000 / bpm;
  tocarClique();
  intervalId = setInterval(tocarClique, intervalo);
}
function pararMetronomo() {
  if (intervalId) {
    clearInterval(intervalId);
    intervalId = null;
  }
}
document.getElementById('btnMetronomo').onclick = () => {
  if (!audioCtxGlobal) {
    audioCtxGlobal = new (window.AudioContext || window.webkitAudioContext)();
  }
  metronomoAtivo = !metronomoAtivo;
  const btn = document.getElementById('btnMetronomo');
  if (metronomoAtivo) {
    btn.textContent = `üéµ Metr√¥nomo: ON (${bpm} BPM)`;
    iniciarMetronomo();
  } else {
    btn.textContent = 'üéµ Metr√¥nomo: OFF';
    pararMetronomo();
  }
};
document.getElementById('inputBPM').onchange = () => {
  let val = parseInt(inputBPM.value);
  if (isNaN(val) || val < 40) val = 40;
  else if (val > 200) val = 200;
  bpm = val;
  inputBPM.value = bpm;
  if (metronomoAtivo) {
    iniciarMetronomo();
    document.getElementById('btnMetronomo').textContent = `üéµ Metr√¥nomo: ON (${bpm} BPM)`;
  }
};
document.getElementById('btnMaisBPM').onclick = () => {
  if (bpm < 200) {
    bpm++;
    inputBPM.value = bpm;
    if (metronomoAtivo) iniciarMetronomo();
    document.getElementById('btnMetronomo').textContent = `üéµ Metr√¥nomo: ON (${bpm} BPM)`;
  }
};
document.getElementById('btnMenosBPM').onclick = () => {
  if (bpm > 40) {
    bpm--;
    inputBPM.value = bpm;
    if (metronomoAtivo) iniciarMetronomo();
    document.getElementById('btnMetronomo').textContent = `üéµ Metr√¥nomo: ON (${bpm} BPM)`;
  }
};
</script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(() => console.log('Service Worker registrado'))
      .catch(err => console.error('Erro ao registrar SW', err));
  }
</script>
</body>
</html>
